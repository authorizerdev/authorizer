!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e="undefined"!=typeof globalThis?globalThis:e||self).framesync={})}(this,(function(e){"use strict";var n=1/60*1e3,t="undefined"!=typeof performance?function(){return performance.now()}:function(){return Date.now()},r="undefined"!=typeof window?function(e){return window.requestAnimationFrame(e)}:function(e){return setTimeout((function(){return e(t())}),n)};var u=!0,o=!1,i=!1,c={delta:0,timestamp:0},f=["read","update","preRender","render","postRender"],d=f.reduce((function(e,n){return e[n]=function(e){var n=[],t=[],r=0,u=!1,o=new WeakSet,i={schedule:function(e,i,c){void 0===i&&(i=!1),void 0===c&&(c=!1);var f=c&&u,d=f?n:t;return i&&o.add(e),-1===d.indexOf(e)&&(d.push(e),f&&u&&(r=n.length)),e},cancel:function(e){var n=t.indexOf(e);-1!==n&&t.splice(n,1),o.delete(e)},process:function(c){var f;if(u=!0,n=(f=[t,n])[0],(t=f[1]).length=0,r=n.length)for(var d=0;d<r;d++){var a=n[d];a(c),o.has(a)&&(i.schedule(a),e())}u=!1}};return i}((function(){return o=!0})),e}),{}),a=f.reduce((function(e,n){var t=d[n];return e[n]=function(e,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!1),o||h(),t.schedule(e,n,r)},e}),{}),s=f.reduce((function(e,n){return e[n]=d[n].cancel,e}),{}),l=f.reduce((function(e,n){return e[n]=function(){return d[n].process(c)},e}),{}),p=function(e){return d[e].process(c)},m=function(e){o=!1,c.delta=u?n:Math.max(Math.min(e-c.timestamp,40),1),c.timestamp=e,i=!0,f.forEach(p),i=!1,o&&(u=!1,r(m))},h=function(){o=!0,u=!0,i||r(m)};e.cancelSync=s,e.default=a,e.flushSync=l,e.getFrameData=function(){return c},Object.defineProperty(e,"__esModule",{value:!0})}));

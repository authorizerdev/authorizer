import { FC, ReactNode } from 'react';
import { User, AuthToken, Authorizer } from '@authorizerdev/authorizer-js';

declare enum Views {
    Login = 0,
    Signup = 1,
    ForgotPassword = 2
}

type AuthorizerConfig = {
    authorizerURL: string;
    redirectURL: string;
    client_id: string;
    is_google_login_enabled: boolean;
    is_github_login_enabled: boolean;
    is_facebook_login_enabled: boolean;
    is_linkedin_login_enabled: boolean;
    is_apple_login_enabled: boolean;
    is_twitter_login_enabled: boolean;
    is_microsoft_login_enabled: boolean;
    is_twitch_login_enabled: boolean;
    is_roblox_login_enabled: boolean;
    is_email_verification_enabled: boolean;
    is_basic_authentication_enabled: boolean;
    is_magic_link_login_enabled: boolean;
    is_sign_up_enabled: boolean;
    is_strong_password_enabled: boolean;
    is_multi_factor_auth_enabled: boolean;
    is_mobile_basic_authentication_enabled: boolean;
    is_phone_verification_enabled: boolean;
};
type AuthorizerState = {
    user: User | null;
    token: AuthToken | null;
    loading: boolean;
    config: AuthorizerConfig;
};
type AuthorizerContextPropsType = {
    config: {
        authorizerURL: string;
        redirectURL: string;
        client_id: string;
        is_google_login_enabled: boolean;
        is_facebook_login_enabled: boolean;
        is_github_login_enabled: boolean;
        is_linkedin_login_enabled: boolean;
        is_apple_login_enabled: boolean;
        is_twitter_login_enabled: boolean;
        is_microsoft_login_enabled: boolean;
        is_twitch_login_enabled: boolean;
        is_roblox_login_enabled: boolean;
        is_email_verification_enabled: boolean;
        is_basic_authentication_enabled: boolean;
        is_magic_link_login_enabled: boolean;
        is_sign_up_enabled: boolean;
        is_strong_password_enabled: boolean;
        is_multi_factor_auth_enabled: boolean;
        is_mobile_basic_authentication_enabled: boolean;
        is_phone_verification_enabled: boolean;
    };
    user: null | User;
    token: null | AuthToken;
    loading: boolean;
    logout: () => Promise<void>;
    setLoading: (data: boolean) => void;
    setUser: (data: null | User) => void;
    setToken: (data: null | AuthToken) => void;
    setAuthData: (data: AuthorizerState) => void;
    authorizerRef: Authorizer;
};

declare const AuthorizerProvider: FC<{
    children: ReactNode;
    config: {
        authorizerURL: string;
        redirectURL: string;
        clientID?: string;
    };
    onStateChangeCallback?: (stateData: AuthorizerState) => Promise<void>;
}>;
declare const useAuthorizer: () => AuthorizerContextPropsType;

type Field = 'given_name' | 'family_name' | 'email_or_phone_number' | 'password' | 'confirmPassword';
type FieldOverride = {
    label: string;
    placeholder: string;
    hide?: boolean;
    notRequired?: boolean;
};
type FormFieldsOverrides = {
    [K in Field]?: FieldOverride;
};
declare const AuthorizerSignup: FC<{
    setView?: (v: Views) => void;
    onSignup?: (data: AuthToken) => void;
    urlProps?: Record<string, any>;
    roles?: string[];
    fieldOverrides?: FormFieldsOverrides;
}>;

declare const AuthorizerBasicAuthLogin: FC<{
    setView?: (v: Views) => void;
    onLogin?: (data: AuthToken | void) => void;
    urlProps?: Record<string, any>;
    roles?: string[];
}>;

declare const AuthorizerMagicLinkLogin: FC<{
    onMagicLinkLogin?: (data: any) => void;
    urlProps?: Record<string, any>;
    roles?: string[];
}>;

declare const AuthorizerForgotPassword: FC<{
    setView?: (v: Views) => void;
    onForgotPassword?: (data: any) => void;
    onPasswordReset?: () => void;
    urlProps?: Record<string, any>;
}>;

declare const AuthorizerSocialLogin: FC<{
    urlProps?: Record<string, any>;
    roles?: string[];
}>;

type Props = {
    showOTPInput?: boolean;
    onReset?: (res: any) => void;
    phone_number?: string;
};
declare const AuthorizerResetPassword: FC<Props>;

declare const AuthorizerVerifyOtp: FC<{
    setView?: (v: Views) => void;
    onLogin?: (data: any) => void;
    email?: string;
    phone_number?: string;
    urlProps?: Record<string, any>;
    is_totp?: boolean;
}>;

declare const AuthorizerRoot: FC<{
    onLogin?: (data: AuthToken | void) => void;
    onSignup?: (data: AuthToken | void) => void;
    onMagicLinkLogin?: (data: any) => void;
    onForgotPassword?: (data: any) => void;
    onPasswordReset?: () => void;
    roles?: string[];
    signupFieldsOverrides?: FormFieldsOverrides;
}>;

declare const AuthorizerTOTPScanner: FC<{
    setView?: (v: Views) => void;
    onLogin?: (data: any) => void;
    email?: string;
    phone_number?: string;
    urlProps?: Record<string, any>;
    authenticator_scanner_image: string;
    authenticator_secret: string;
    authenticator_recovery_codes: string[];
}>;

export { AuthorizerRoot as Authorizer, AuthorizerBasicAuthLogin, AuthorizerForgotPassword, AuthorizerMagicLinkLogin, AuthorizerProvider, AuthorizerResetPassword, AuthorizerSignup, AuthorizerSocialLogin, AuthorizerTOTPScanner, AuthorizerVerifyOtp, useAuthorizer };
